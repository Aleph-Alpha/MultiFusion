<html>

<head lang="en">
    <!-- https://stackoverflow.com/questions/16316311/github-pages-and-relative-paths -->
    <base href="/[repo]/"> 
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>MultiFusion: Fusing Pre-Trained Models for Multi-Lingual, Multi-Modal Image Generation</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
    <link rel="stylesheet" href="css/app.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
    
    <script src="js/app.js"></script>
</head>

<body>
    <div class="container" id="main" style="background-color: rgba(255, 255, 255, 0.9);">
        <div class="row">
            <h2 class="col-md-12 text-center">
                MultiFusion: Fusing Pre-Trained Models for Multi-Lingual, Multi-Modal Image Generation
            </h2>
        </div>

        <style>      
            .author-info {
                text-align: center;
                margin-right: 40px; /* Adjust this to move the block to the right */
            }
            
            .author {
                display: flex;
                justify-content: center;
                gap: 35px; /* Change this value to adjust space between authors */
            }
            
            .author li, .affiliation {
                list-style-type: none; /* This will remove the bullet points */
            }
            
            .affiliation {
                margin-top: 5px; /* Smaller values to reduce space */
                margin-bottom: 5px;
            }
            
            .author-name {
                font-size: 20px; /* Adjust this value to increase or decrease the author name size */
            }

            .author-aff {
                font-size: 10px; /* Adjust this value to increase or decrease the author name size */
            }
            /* Medium screens (Tablets) */
            @media only screen and (max-width: 1024px) {
                .author-name {
                    font-size: 18px;
                }
                .affiliation {
                    font-size: 13px;
                }
                .author {
                    gap: 20px;
                }
                .author-aff {
                    font-size: 9px;
                }
            }
            
            /* Medium screens (Tablets) */
            @media only screen and (max-width: 768px) {
                .author-name {
                    font-size: 16px;
                }
                .affiliation {
                    font-size: 12px;
                }
                .author {
                    gap: 15px;
                }
                .author-aff {
                    font-size: 8px;
                }
            }
            </style>
            
            <div class="row">
                <div class="col-md-12 text-center">
                    <ul class="author-info">
                        <div class="author">
                            <li>
                                <a href="" class="author-name">Marco Bellagente</a><sup class="author-aff">&ast;&plus; 4</sup><br/>
                            </li>
                            <li>
                                <a href="" class="author-name">Manuel Brack</a><sup class="author-aff">&ast; 2,3</sup><br/>
                            </li>
                            <li>
                                <a href="" class="author-name">Hannah Teufel</a><sup class="author-aff">&ast; 1</sup><br/>
                            </li>
                         </div>
                         <div class="author">
                            <li>
                                <a href="" class="author-name">Felix Friedrich</a><sup class="author-aff">3,6</sup><br/>
                            </li>

                            <li>
                                <a href="" class="author-name">Bj√∂rn Deiseroth</a><sup class="author-aff">1,3,6</sup><br/>
                            </li>
                            <li>
                                <a href="" class="author-name">Constantin Eichenberg</a><sup class="author-aff">1</sup><br/>
                            </li>
                            <li>
                                <a href="" class="author-name">Andrew Dai</a><sup class="author-aff">1</sup><br/>
                            </li>
                            <li>
                                <a href="" class="author-name">Robert J.N. Baldock</a><sup class="author-aff">1</sup><br/>
                            </li>
                          </div>
                          <div class="author">
                            <li>
                                <a href="" class="author-name">Souradeep Nanda</a><sup class="author-aff">&plus; 5</sup><br/>
                            </li>
                            <li>
                                <a href="" class="author-name">Koen Oostermeijer</a><sup class="author-aff">1</sup><br/>
                            </li>
                            <li>
                                <a href="" class="author-name">Andres Felipe Cruz-Salinas</a><sup class="author-aff">1</sup><br/>
                            </li>  
                            <li>
                                <a href="" class="author-name">Patrich Schramowski</a><sup class="author-aff">2,3,6,8</sup><br/>
                            </li>
			</div>
			    <div class="author">
                            <li>
                                <a href="" class="author-name">Kristian Kersting</a><sup class="author-aff">&#10022; 2,3,6,7</sup><br/>
                            </li> 
                            <li>
                                <a href="" class="author-name">Samuel Weinbach</a><sup class="author-aff">&#10022; 1</sup><br/>
                            </li>                          
                        </div>
                        <li class="affiliation">
                            <sup>1</sup>Aleph Alpha &emsp; <sup>2</sup>German Research Center for Artificial Intelligence (DFKI)  
                        </li>
                        <li class="affiliation">
                           <sup>3</sup>Computer Science Department, TU Darmstadt &emsp; <sup>4</sup>Stability AI &emsp; <sup>5</sup>University of Texas  
                        </li>
                        <li class="affiliation">
                            <sup>6</sup>Hessian.AI &emsp; <sup>7</sup>Centre for Cognitive Science, TU Darmstadt &emsp; <sup>8</sup>LAION &emsp;
                        </li>
                        <li class="affiliation">
                            (&plus;) Work performed while at Aleph Alpha
                            (&ast;) equal contribution
                            (&#10022;) equal supervision
                        </li>
                    </ul>
                </div>
            </div>

              <style>
                .link-content {
                  text-align: center;
                }
                
                .list-inline li {
                  margin-right: 90px;  /* Adjust this value to increase/decrease the gap between items */
                  margin-left: 90px;
                }
                
                </style>
                
                <div class="row">
                  <div class="col-md-12 text-center">
                    <ul class="list-inline">
                      <li>
                        <a href="https://arxiv.org/abs/2305.15296">
                          <div class="link-content">
                            <h4><strong>Paper</strong></h4>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a href="https://huggingface.co/datasets/AIML-TUDA/MCC-250">
                          <div class="link-content">
                            <h4><strong>MCC-250 Benchmark Dataset</strong></h4>
                          </div>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>


        
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Abstract
                </h3>
                <p class="text-justify">
                The recent popularity of text-to-image diffusion models (DM) can largely be attributed to 
the intuitive interface they provide to users. The intended generation can be expressed in natural language, with the model producing faithful interpretations of text prompts. 
However, expressing complex or nuanced ideas in text alone can be difficult. To ease image generation, 
we propose MultiFusion that allows one to express complex and nuanced concepts with arbitrarily interleaved inputs of multiple modalities and languages. 
MultiFusion leverages pre-trained models and aligns them for integration into a cohesive system, thereby avoiding the need for extensive training from scratch. 
Our experimental results demonstrate the efficient transfer of capabilities from individual modules to the downstream model. Specifically, the fusion of all independent components allows the image generation module to utilize multilingual, interleaved multimodal inputs despite being trained solely on monomodal data in a single language. 
                </p>
            </div>
        </div> 

	<div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Method
                </h3>
		<p class="text-justify">
		To enable multimodal, multilingual prompting, both compute efficiently and without multimodal downstream training data we use a custom modular encoder. 

		The base of our encoder is a 13B autoregressive transformer (1.1), pretrained on 5 languages (English, German, Spanish, Italian and French).
		We extend the encoder by an image prefix as well as adapters (1.2) to enable multimodality. Additionally, we finetune the biases (2.1) of the LLM to provide embeddings, which capture the semantic meaning of 
       		the text prompt, thus simplifying the learning of mapping from embeddings to image outputs. Finally, to align the pre-trained Stable Diffusion model (1.4) with the embeddings of our modular 
       		encoder, we retrain the conditioning by finetuning the cross-attention weights (2.2). 
		</p>
                <image src="src/imgs/architecture.png"><br>
            </div>
        </div>

	<div class="row">
        <div class="col-md-8 col-md-offset-2">
		<h3>
	        Evaluation
	        </h3>
		<h4>Image Fidelity and Text-to-Image Alignment</h4>
		<p>We meassure image fidelity and image-text-alignment using the standard metrics FID-30K and Clip Scores. We find that MultiFusion prompted with text only performs on par with Stable Diffusion despite extension of the Encoder to support multiple languages and modalities.</p>
		<image style='border:1px solid #000000' src="src/imgs/evaluation.png" class="img-responsive"><br>
		<h4>Compositional Robustness</h4>
		<p>Image Composition is a known limitation of Diffusion Models. Through evaluation of our new benchmark <a href="https://huggingface.co/datasets/AIML-TUDA/MCC-250">MCC-250</a> we show that multimodal prompting leads to more compositional robustness as judged by humans.</p>
		<image style='border:1px solid #000000' src="src/imgs/compositional_robustness.png" class="img-responsive" alt="method"><br>
		<h4>Multilinguality</h4>
		<image style='border:1px solid #000000' src="src/imgs/multilingual_alignment.png" class="img-responsive" alt="method"><br>	
		<p>Evaluating the alignment of prompt embeddings as well as generated images across multiple languagese we show that well aligned embeddings enable the transfer of multiligualism to downstream tasks even for task-specific monolingual training data.</p>
		<image style='border:1px solid #000000' src="src/imgs/multilingual_evaluation_graphs.png" class="img-responsive" alt="method"><br>	
	</div>
        </div>
		<div class="row">
            <div class="col-md-8 col-md-offset-2">
	<h3>
        Attention Manipulation for Multimodal inference
        </h3>
	<p> Attention Manipulation allows us to weight image and text tokens at inference time and guide their influence on the resulting generation. </p>
	<image style='border:1px solid #000000' src="src/imgs/attn_manipulation.png" class="img-responsive" alt="method"><br>	
	</div>
        </div>

	<div class="row">
        <div class="col-md-8 col-md-offset-2">
		<h3>
	        Applications
	        </h3>
		<h4>Interleaved multilingual, multimodal prompting</h4>
		<image style='border:1px solid #000000' src="src/imgs/prompting_example.png" class="img-responsive" alt="method"><br>	
		<h4>Image Composition</h4>
		<p>MultiFusion increases expressivness in composition through arbitrary and flexible promptin of image and text sequences.</p>
		<image style='border:1px solid #000000' src="src/imgs/image_composition.png" class="img-responsive" alt="method"><br>	
		<h4>Negative Prompting</h4>
		<p>Negative prompting with images enables a more powerful supression than through text prompts.</p>
		<image style='border:1px solid #000000' src="src/imgs/negative_prompting.png" class="img-responsive" alt="method"><br>	
		<h4>Style Modification</h4>
		MultiFusion enables simple style transfer through one reference image capturing all the facets of a unique style such as color pallette, composition contrast, etc. making elaborate prompts obsolete. Additionally, MultiFusion enables highly individual prompting such as "in the style of a picture I drew".
		<image style='border:1px solid #000000' src="src/imgs/style_transfer.png" class="img-responsive" alt="method"><br>	
		<h4>Image Variation</h4>
		<p>MultiFusion produces meaningful image variations without the need for inversion or renoising if the input image.</p>
		<image style='border:1px solid #000000' src="src/imgs/image_variation.png" class="img-responsive" alt="method"><br>	
	
	</div>
        </div>
        
	<div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Follow-Up Work
                </h3>
                <p> 
                In order to contribute to the fair evaluation and safety of large generative models we opened our model for the evaluation on the Holisitic Evaluation of Text-to-Image Models (HEIM) benchmark [<a href="https://crfm.stanford.edu/heim/v1.1.0/">results</a>, <a href="https://arxiv.org/abs/2311.04287">paper</a>]. As well as for a study on the mitigation of inapproriatness in image generation [<a href="https://arxiv.org/abs/2305.18398">paper</a>]
                </p>
                </div>
              </div>
        
                <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Citation
                </h3>
                <div class="form-group col-md-10 col-md-offset-1">
                    <pre id="bibtex" readonly>
@article{bellagente2023multifusion,
      title={MultiFusion: Fusing Pre-Trained Models for Multi-Lingual, Multi-Modal Image Generation}, 
      author={Marco Bellagente and Manuel Brack and Hannah Teufel and Felix Friedrich and Bj√∂rn Deiseroth and Constantin Eichenberg and Andrew Dai and Robert Baldock and Souradeep Nanda and Koen Oostermeijer and Andres Felipe Cruz-Salinas and Patrick Schramowski and Kristian Kersting and Samuel Weinbach},
      year={2023},
      journal={arXiv preprint arXiv:2305.15296},
}</pre>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Acknowledgements
                </h3>
                <p class="text-justify">
                The website template was borrowed from <a href="https://jonbarron.info/">Jon Barron</a>.
                </p>
		<br>
            </div>
        </div>
    </div>
</body>
</html>
